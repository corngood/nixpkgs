set -e

genericBuild

depsFile=$(realpath "${1:-@defaultDepsFile@}")

(
    echo -e "# This file was automatically generated by passthru.fetch-deps.\n# Please dont edit it manually, your changes might get overwritten!\n"
    @nugetToNix@/bin/nuget-to-nix "${NUGET_PACKAGES%/}"
) > deps.nix

mv deps.nix "$depsFile"
echo "Succesfully wrote lockfile to $depsFile"
